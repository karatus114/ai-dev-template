Conventional Commits形式でコミットを作成します。

## 手順

### 1. 変更内容を確認する

以下のコマンドを実行して、変更内容を確認してください：

```bash
# ステージングエリアの変更を確認
git diff --staged

# ステージングされていない変更も確認
git status
```

### 2. type を判断する

docs/GIT_RULES.md に従って、変更内容から適切な type を判断してください。

| type | 用途 | 例 |
|------|------|---|
| `feat` | 新機能の追加 | `feat: ユーザー検索機能を追加` |
| `fix` | バグ修正 | `fix: パスワードリセット時のエラーを修正` |
| `docs` | ドキュメントのみの変更 | `docs: API仕様書を更新` |
| `style` | コードの動作に影響しない変更 | `style: インデントを修正` |
| `refactor` | リファクタリング | `refactor: UserServiceを関数に分割` |
| `test` | テストの追加・修正 | `test: ユーザー登録のテストを追加` |
| `chore` | ビルドプロセスやツールの変更 | `chore: 依存関係を更新` |
| `perf` | パフォーマンス改善 | `perf: データベースクエリを最適化` |

### 3. コミットメッセージを生成する

以下の形式でコミットメッセージを生成してください：

```
<type>: <subject>
```

#### subject のルール

- **現在形で記述する**（「追加した」ではなく「追加」）
- **日本語または英語**
- **50文字以内**を推奨
- **ピリオドで終わらない**

#### 良い例・悪い例

```
✅ 良い例:
feat: ユーザー検索機能を追加
fix: ログイン時の認証エラーを修正
docs: セットアップ手順を更新
test: ユーザー作成のテストを追加

❌ 悪い例:
add user search  (typeがない)
fixed bug  (具体性がない)
feat: ユーザー検索機能を追加しました。 (過去形、ピリオド)
update code  (何を更新したか不明)
```

### 4. ユーザーに確認する

生成したコミットメッセージをユーザーに提示し、確認してください。

**例**:
```
以下の内容でコミットします。よろしいですか？

feat: ユーザー検索機能を追加

変更されたファイル:
- src/services/UserService.ts
- src/controllers/UserController.ts
- src/routes/users.ts
```

### 5. コミットを実行する

ユーザーの承認が得られたら、コミットを実行してください：

```bash
git commit -m "feat: ユーザー検索機能を追加"
```

### 6. プッシュしない

**重要**: このコマンドではプッシュを行いません。

ユーザーが明示的に `git push` を実行するか、`/create-pr` コマンドでPR作成時にプッシュしてください。

## 詳細な本文が必要な場合

複雑な変更の場合は、本文（body）を追加できます。

### 形式

```
<type>: <subject>

<body>

<footer>
```

### 例

```
feat: ユーザー検索機能を追加

名前、メールアドレス、登録日で検索できるようにした。
ページネーションにも対応している。

Closes #123
```

## 破壊的変更の場合

APIの互換性を壊す変更の場合は、`BREAKING CHANGE:` を追加してください。

```
feat: 認証APIをv2に更新

BREAKING CHANGE: /api/auth/login のレスポンス形式が変更されました

Closes #456
```

## コミット前のチェックリスト

コミット前に、以下を確認してください：

- [ ] テストがパスしているか
- [ ] リンター・フォーマッターを実行したか
- [ ] 不要なファイルが含まれていないか（.env, node_modules/等）
- [ ] 機密情報がハードコードされていないか
- [ ] console.log()等のデバッグコードが削除されているか
- [ ] コミットメッセージが適切か

## 出力メッセージ

コミット完了後、以下のメッセージを表示してください：

```
✅ コミットが完了しました！

📝 コミットメッセージ:
feat: ユーザー検索機能を追加

🔍 変更されたファイル:
- src/services/UserService.ts
- src/controllers/UserController.ts
- src/routes/users.ts

🚀 次のステップ:
- 次の機能を実装する場合: 作業を続けてください
- PRを作成する場合: `/create-pr` を実行してください
- コードレビューをする場合: `/code-review` を実行してください

💡 注意: プッシュはまだ実行されていません
```

## Git Hooksへの対応

### pre-commit フックが失敗した場合

pre-commit フックでリンター・フォーマッターが実行され、エラーが発生した場合：

1. **エラーを確認**
2. **修正する**
3. **再度コミット**

### commit-msg フックが失敗した場合

コミットメッセージが Conventional Commits 形式に従っていない場合：

1. **エラーを確認**
2. **コミットメッセージを修正**
3. **再度コミット**

## 注意

- Conventional Commits 形式に厳密に従ってください
- 複数の変更を1つのコミットにまとめないでください
- テストが失敗している状態でコミットしないでください
- 機密情報を含むファイルをコミットしないでください

## 参考資料

- [docs/GIT_RULES.md](../docs/GIT_RULES.md) - Git運用ルール
- [Conventional Commits](https://www.conventionalcommits.org/)
