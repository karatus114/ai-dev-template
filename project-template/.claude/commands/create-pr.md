プルリクエスト（PR）を作成します。

## 前提条件

- コミットが完了していること
- ブランチがリモートにプッシュされていること（または自動でプッシュします）

## 手順

### 1. ブランチ名からIssue番号を抽出する

現在のブランチ名から Issue番号を抽出してください。

```bash
# ブランチ名を取得
git branch --show-current
```

**例**:
```
ブランチ名: feat/123-user-search
→ Issue番号: 123
```

### 2. コミット履歴から変更を要約する

以下のコマンドでコミット履歴を確認し、変更内容を要約してください：

```bash
# mainブランチとの差分を確認
git log main..HEAD --oneline
```

### 3. PR本文を作成する

`.github/PULL_REQUEST_TEMPLATE.md` のテンプレートに沿って本文を作成してください。

#### テンプレート

```markdown
## 概要

[変更内容の概要を記載]

## 変更内容

- [ ] [変更内容1]
- [ ] [変更内容2]
- [ ] [変更内容3]

## 関連Issue

Closes #[Issue番号]

## テスト

- [ ] ユニットテストが通ることを確認
- [ ] 手動テストで動作確認

## レビュー観点

- セキュリティ上の問題がないか
- パフォーマンスに影響がないか
- コード規約に従っているか
```

#### 本文作成の例

コミット履歴:
```
feat: ユーザー検索APIを実装
test: ユーザー検索のテストを追加
docs: API仕様書を更新
```

PR本文:
```markdown
## 概要

ユーザー検索機能を追加しました。名前、メールアドレス、登録日で検索できます。

## 変更内容

- [x] ユーザー検索APIの実装
- [x] テストの追加（正常系、異常系、境界値）
- [x] API仕様書の更新

## 関連Issue

Closes #123

## テスト

- [x] ユニットテストが通ることを確認（15件すべてパス）
- [x] 手動テストで動作確認
  - 名前検索が正常に動作
  - メールアドレス検索が正常に動作
  - ページネーションが正常に動作

## レビュー観点

- セキュリティ上の問題がないか
  - 入力検証が実装されているか
  - SQLインジェクション対策がされているか
- パフォーマンスに影響がないか
  - N+1問題が発生していないか
  - 適切なインデックスが設定されているか
```

### 4. リモートへのプッシュを確認する

現在のブランチがリモートにプッシュされているか確認してください：

```bash
git status
```

**プッシュされていない場合**:

```bash
# リモートにプッシュ
git push -u origin [ブランチ名]
```

### 5. PR を作成する

GitHub CLI (`gh`) を使用してPRを作成してください：

```bash
gh pr create --title "[タイトル]" --body "[本文]"
```

#### タイトルの形式

コミットメッセージと同じ Conventional Commits 形式を使用してください。

```
feat: ユーザー検索機能を追加
fix: ログイン時のバリデーションエラーを修正
```

#### コマンド例

```bash
gh pr create \
  --title "feat: ユーザー検索機能を追加" \
  --body "$(cat <<'EOF'
## 概要

ユーザー検索機能を追加しました。

## 変更内容

- [x] ユーザー検索APIの実装
- [x] テストの追加
- [x] API仕様書の更新

## 関連Issue

Closes #123

## テスト

- [x] ユニットテストが通ることを確認
- [x] 手動テストで動作確認

## レビュー観点

- セキュリティ上の問題がないか
- パフォーマンスに影響がないか
EOF
)"
```

### 6. PR URL を返す

PR作成が完了したら、PR URL を表示してください。

## 出力メッセージ

PR作成完了後、以下のメッセージを表示してください：

```
✅ プルリクエストが作成されました！

🔗 PR URL:
https://github.com/[owner]/[repo]/pull/[number]

📋 PR タイトル:
feat: ユーザー検索機能を追加

📝 関連Issue:
Closes #123

🚀 次のステップ:
1. PR ページでCIの結果を確認してください
2. レビュアーを割り当ててください
3. レビューのフィードバックに対応してください
4. 承認されたらマージしてください

💡 レビュー依頼:
`/code-review` コマンドで自己レビューを実施してから、レビュアーに依頼することを推奨します
```

## エラー時の対応

### GitHub CLI がインストールされていない場合

```
❌ エラー: GitHub CLI (gh) がインストールされていません

インストール方法:
- macOS: `brew install gh`
- Windows: `winget install GitHub.cli`
- Linux: https://github.com/cli/cli#installation

インストール後、以下のコマンドで認証してください:
`gh auth login`
```

### GitHub CLI が認証されていない場合

```
❌ エラー: GitHub CLI が認証されていません

以下のコマンドで認証してください:
`gh auth login`
```

### リモートブランチが存在しない場合

```
❌ エラー: リモートブランチが存在しません

以下のコマンドでプッシュしてください:
`git push -u origin [ブランチ名]`
```

### コンフリクトが存在する場合

```
❌ エラー: mainブランチとコンフリクトがあります

以下の手順で解決してください:
1. mainブランチを取得: `git fetch origin main`
2. mainブランチをマージ: `git merge origin/main`
3. コンフリクトを解決
4. コミット: `git commit`
5. プッシュ: `git push`
```

## 注意

- PRを作成する前に、必ずテストがパスしていることを確認してください
- CIが設定されている場合は、CI結果を確認してください
- コンフリクトがある場合は、先に解決してください
- `/code-review` で自己レビューを実施してから PR を作成することを推奨します

## 参考資料

- [docs/GIT_RULES.md](../docs/GIT_RULES.md) - Git運用ルール
- [.github/PULL_REQUEST_TEMPLATE.md](../.github/PULL_REQUEST_TEMPLATE.md) - PRテンプレート
